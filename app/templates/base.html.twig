<!DOCTYPE html>
<html lang="fr" data-bs-theme="light">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>{% block title %}Welcome!{% endblock %}</title>
        <link rel="icon" href="/images/favicon.png">
        {% block stylesheets %}
        
        

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" 
            integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

        <link rel="stylesheet" href="{{ asset('styles/app.css') }}">
        {% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
    </head>
    <body id="top">

        {% include 'partial/navbar.html.twig' %}
        {% include 'partial/flash.html.twig' %}

        {% block body %}
        
        {% endblock %}

        {% include 'partial/footer.html.twig' %}
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"></script>
        <a href="#top" class="back-to-top" aria-label="Retour en haut">
            <i class="bi bi-arrow-up"></i>
        </a>
        <script>
            (function () {
            const STORAGE_KEY = 'theme';           // 'light' | 'dark' | 'auto'
            const html = document.documentElement;
            const btn  = document.getElementById('theme-toggle');
            const mq   = window.matchMedia('(prefers-color-scheme: dark)');

            function stored() { return localStorage.getItem(STORAGE_KEY) || 'auto'; }

            function apply(mode) {
                const m = (mode === 'auto') ? (mq.matches ? 'dark' : 'light') : mode;
                html.setAttribute('data-bs-theme', m);
                if (!btn) return;
                btn.setAttribute('aria-pressed', m === 'dark' ? 'true' : 'false');
                btn.innerHTML = (m === 'dark')
                ? '<i class="bi bi-sun"></i><span class="d-none d-sm-inline">Light</span>'
                : '<i class="bi bi-moon"></i><span class="d-none d-sm-inline">Dark</span>';
            }

            // Init
            apply(stored());

            // OS change (en mode auto)
            mq.addEventListener('change', () => { if (stored() === 'auto') apply('auto'); });

            // Clic : light → dark → auto
            btn?.addEventListener('click', () => {
                const cur = stored();
                const next = cur === 'light' ? 'dark' : (cur === 'dark' ? 'auto' : 'light');
                localStorage.setItem(STORAGE_KEY, next);
                apply(next);
            });
            })();
        </script>

    </body>

</html>
